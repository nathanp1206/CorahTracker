<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="apple-touch-icon" href="img/CorahTracker.png">
  <link rel="icon" href="img/CorahTracker.ico" type="image/x-icon">
  <title>Corah Stats</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <button id="logout-btn" style="position:fixed;top:12px;right:18px;z-index:3000;background:#2d6cdf;color:#fff;border:none;border-radius:50%;width:28px;height:28px;font-size:1.1em;line-height:1;cursor:pointer;padding:0;">X</button>
  <button class="hamburger-menu" onclick="toggleTabs()"><span class="hamburger-icon"><span></span><span></span><span></span></span></button>
  <div class="tabs">
    <a href="/" class="tab-button active">Summary</a>
    <a href="/add-data/" class="tab-button">Add Data</a>
    <a href="/graphs/" class="tab-button">Graphs</a>
    <a href="/scrolls/" class="tab-button">Scrolls</a>
    <a href="/mobs/" class="tab-button">Mob Stats</a>
    <a href="/levels/" class="tab-button">Levels</a>
  </div>

  <div class="container">
    <div class="summary-layout">
      <div class="content-box" id="latest-player-stats">
        <div class="header-row">
          <select id="summaryPlayerSelect" style="margin-bottom: 1em;"></select>
          <h2>Latest Player Stats</h2>
        </div>
        <div id="player-stats-list">
          <!-- Player stats will be loaded here by JavaScript -->
          Loading stats...
        </div>
      </div>

      <!-- Average Daily XP Section -->
      <div class="content-box" id="average-daily-xp">
          <h2>Average Daily XP</h2>
          <div class="average-xp-grid">
              <div class="grid-item player-select">
                  <label for="avgXpPlayerSelect">Player:</label>
                  <select id="avgXpPlayerSelect"></select>
              </div>
              <div class="grid-item initial-datetime">
                  <label for="avgXpInitialTimeSelect">Initial Date and Time:</label>
                  <select id="avgXpInitialTimeSelect"></select>
              </div>
              <div class="grid-item latest-datetime">
                  <label for="avgXpLatestTimeSelect">Latest Date and Time:</label>
                  <select id="avgXpLatestTimeSelect"></select>
              </div>
              <div class="grid-item average-xp">
                  <h3>Average Daily XP</h3>
                  <p><strong>Total XP Gained:</strong> <span id="totalXpGained">--</span></p>
                  <p><strong>Days Between:</strong> <span id="daysBetween">--</span></p>
                  <p><strong>Average Daily XP:</strong> <span id="averageDailyXp">--</span></p>
                  <div class="goal-level-section">
                      <label for="avgXpGoalLevel">Goal Level:</label>
                      <select id="avgXpGoalLevel"></select>
                      <p><strong>Expected Date to Hit Goal:</strong> <span id="avgXpExpectedDate">--</span></p>
                  </div>
              </div>
          </div>
      </div>

      <!-- New Player Snapshot Section -->
      <div class="content-box" id="player-snapshot">
          <h2>Player Snapshot</h2>
          <div class="snapshot-grid">
              <div class="grid-item player-select">
                  <label for="snapshotPlayerSelect">Player:</label>
                  <select id="snapshotPlayerSelect"></select>
              </div>
              <div class="grid-item goal-datetime">
                  <label for="goalDate">Goal Date:</label>
                  <input type="date" id="goalDate">
              </div>
              <div class="grid-item initial-datetime">
                  <label for="snapshotTimeSelect">Initial Date and Time:</label>
                  <select id="snapshotTimeSelect"></select>
              </div>
              <div class="grid-item goal-level">
                  <label for="goalLevel">Goal Level:</label>
                  <select id="goalLevel"></select>
              </div>
              <div class="grid-item daily-xp">
                  <h3>Daily XP Needed</h3>
                  <p><strong>Required Daily EXP:</strong> <span id="dailyXPNeeded">--</span></p>
              </div>
              <div class="grid-item goal-snapshot">
                  <h3>Goal Snapshot</h3>
                  <p><strong>Level:</strong> <span id="goalLevelDisplay">--</span></p>
                  <p><strong>Experience:</strong> <span id="goalXP">--</span></p>
              </div>
              <div class="grid-item initial-snapshot">
                  <h3>Initial Snapshot</h3>
                  <p><strong>Level:</strong> <span id="initialLevel">--</span></p>
                  <p><strong>Experience:</strong> <span id="initialXP">--</span></p>
              </div>
          </div>
      </div>

      <!-- Custom XP/Gold/Monster Calculation Section -->
      <div class="content-box" id="custom-xp-gold-monster">
        <h2>Average Daily XP(No Scrolls)</h2>
        <div class="snapshot-grid">
          <div class="grid-item player-select">
            <label for="customPlayerSelect">Player:</label>
            <select id="customPlayerSelect"></select>
          </div>
          <div class="grid-item initial-datetime">
            <label for="customStartTimeSelect">Start Date and Time:</label>
            <select id="customStartTimeSelect"></select>
          </div>
          <div class="grid-item latest-datetime">
            <label for="customEndTimeSelect">End Date and Time:</label>
            <select id="customEndTimeSelect"></select>
          </div>
          <div class="grid-item xp-rate">
            <label for="customXpRate">XP Rate(eg. 347.23):</label>
            <input type="number" id="customXpRate" placeholder="Enter XP rate">
          </div>
          <div class="grid-item gold-rate">
            <label for="customGoldRate">Gold Rate(eg. 90.03):</label>
            <input type="number" id="customGoldRate" placeholder="Enter Gold rate">
          </div>
          <div class="grid-item monster-select">
            <label for="customMonsterSelect">Monster:</label>
            <select id="customMonsterSelect"></select>
          </div>
        </div>
        <div class="custom-averages" style="margin-top:2em;">
          <!-- <h3>Averages</h3> -->
          <p><strong>Average Daily XP:</strong> <span id="customAvgDailyXp">--</span></p>
          <p><strong>Average Daily Gold:</strong> <span id="customAvgDailyGold">--</span></p>
          <p><strong>Average Daily Mob Kills:</strong> <span id="customAvgDailyMobKills">--</span></p>
          <p><strong>Average Mob Kills per Minute:</strong> <span id="customAvgMobKillsPerMinute">--</span></p>
          <p><strong>Average Gold per Kill:</strong> <span id="customAvgGoldPerKill">--</span></p>
          <p style="display:none;"><strong>Average % of Mob Killed:</strong> <span id="customAvgPercentMobKilled">--</span></p>
        </div>
      </div>
    </div>
  </div>

  <script src="js/search.js"></script>
  <script src="js/script.js"></script>
  <script type="module" src="js/header.js"></script>
  <script>
    function toggleTabs() {
      const tabs = document.querySelector('.tabs');
      tabs.classList.toggle('active');
    }
    document.getElementById('logout-btn').onclick = function() {
      localStorage.removeItem('jwt');
      window.location.href = '/login.html';
    };
  </script>
  <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="hunt3r1206" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
</body>
</html>
